# Введение Spectrogram

```diff
- В данном проекте использовались библиотеки: CUDA, OpenCV, CVPlot, fftw.
```

В данной лабораторной работе содержится 7 файлов.
1. Заголовочный файл - main.h, в котором подгружаются все библиотеки, находятся параметры для работы программы, прототипы функций и структур
2. Основной файл - main.cpp, через который происходит запуск программы
3. Функция для чтения wav файлов - WavReader.cpp
4. Функция для построения спектра через CPU - spectrogram.cpp
5. Функция для построения спектра через GPU - spectrogram_cuda.cu
6. Функция для отображения изображений - imageView.cpp
7. Функция для красивого отображения текста - just_output.cpp

# Параметры

В main.h находятся параметры , с помощью которых, можно регулировать работу программы:
1. mode - Режим отображения данных (0 - не отображать и не сохранять, 1 - отображать изображения, 2 - сохранять изображения, 3 - отображать и сохранять)
2. interactive - Режим интерактивных графиков (0 - выключить, 1 - включить)
3. multichannel - Режим мультикональности на одном изображении (0 - на разных изображениях, 1 - на одном изображении)
4. output - Показ изображений (0 - все изображения, 1 - только спектры)
5. processor - Использование процессора (0 - CPU, 1 - GPU, 2 - CPU & GPU)
6. width и height - Отвечающие за размер выходного изображения
7. extension - Отвечающий за расширение выходного файла

# Функции

Файл main.cpp, является основным, с помощью которого происходит запуск программы. В нем вызываются функции чтения и обработки данных, а также измеряется время выполнения программы.

Чтения данных осуществляется через функцию wav_Reader. Для начала файл проходит проверку на то, является ли он wav файлом и имеет ли нужную структуру, после чего проиходит чтение data данных и их обработка в double формат. А дальше, в зависимости от колличества каналов, происходит выгрузка данных в вектора.

Построение спектра на CPU происходит посредством функции spectrogram_from_signal, на GPU посредством spectrogram_from_signal_cuda. Основная механика данных функций схожа, создаются комплексные и векторные переменные по заданному размеру, в зависимости от количества каналов. А после для каждого из каналов вызывается функция, в которой происходит БПФ и последующая обработка данных. Распараллеливание просиходило в момент времени обработки данных, когда происходит взятие квадратного корня из перемножение мнимой и действительной части.

Оставшиеся два файла служат для отображения изоражений и вывода текста.

Ниже представлен пример работы программы (за основу был взял написанный заранее для теста звук, длительностью 2сек "test". А также взятый трек с интернет ресурсов "The_Rebel_Path" длительностью 4.10 мин.

```diff
- Выполнение программы проводилось с одинаковыми параметрами: 3, 0, 1, 0, 2, 1280x720, .bmp.
```

Форма сигнала звука test (красный - левый канал, зеленый - правый канал)
![SoundGraph](https://user-images.githubusercontent.com/31400073/204161159-e9f3acfe-7834-4f7d-9ff7-e0741c4fdbc3.png)
Спектрограмма через CPU
![Spectrogram_CPU](https://user-images.githubusercontent.com/31400073/204161167-92f4af8b-b3a6-41fb-97da-8a1d370dcc60.png)
Спектрограмма через GPU
![Spectrogram_GPU](https://user-images.githubusercontent.com/31400073/204161171-78103d3a-5bac-49a0-a04c-d799d90581ba.png)
Вывод в консоль
![console_no_image](https://user-images.githubusercontent.com/31400073/204161287-506e29a1-4687-43a8-acd4-a6199c7e8c4a.jpg)

Форма сигнала звука The_Rebel_Path (красный - левый канал, зеленый - правый канал)
![SoundGraph](https://user-images.githubusercontent.com/31400073/204161241-111087fa-32ff-440b-a5f1-dc290794df69.png)
Спектрограмма через CPU
![Spectrogram_CPU](https://user-images.githubusercontent.com/31400073/204161258-5b1f873c-70f6-4210-b5e1-2280419bd411.png)
Спектрограмма через GPU
![Spectrogram_GPU](https://user-images.githubusercontent.com/31400073/204161266-097df819-fd81-4c33-80f7-6dd879088db7.png)
Вывод в консоль
![console_no_image](https://user-images.githubusercontent.com/31400073/204161293-088640c9-1319-42f0-b7cf-e96e930ef344.jpg)
